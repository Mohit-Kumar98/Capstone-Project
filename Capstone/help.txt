import pdfplumber

all_content=[]
content=[]
table_content=[]

def list_pdf_files_in_directory(directory_path):
    try:
        # List all files and directories in the given path
        files_and_dirs = os.listdir(directory_path)
        
        # Filter out directories and non-PDF files, keeping only PDF files
        pdf_files = [f for f in files_and_dirs if os.path.isfile(os.path.join(directory_path, f)) and f.lower().endswith('.pdf')]
        
        return pdf_files
    except FileNotFoundError:
        print(f"The directory {directory_path} does not exist.")
        return []


pdf_files = list_pdf_files_in_directory(DATA_PATH)



# Open the PDF file
for name in pdf_files:
    with pdfplumber.open(DATA_PATH+"/"+name) as pdf:
        for page_number, page in enumerate(pdf.pages):
            pg = page_number
            text = page.extract_text()
            source= name
            content.append({'page': pg+1,'text':text, 'source':source})
            res_in  = ""

            # Extract tables
            tables = page.extract_tables()
            # print(type(tables))
            # print("Tables:")
            for table in tables:
                res_in = ""
                for row in table:
                    res_in = res_in + ' '.join([str(r) for r in row])
                table_content.append({'page': pg+1,'text':res_in, 'source':source})
            # res_in = res_in + text
        all_content.extend(content)
        all_content.extend(table_content)


You are an AI tasked with summarizing a company's financial reports, including multiple financial analyst reports and the company's 10-K report. The goal is to create concise 1-page and 2-page summaries that provide a comprehensive overview of the company's financial position.

Analyze the provided financial reports and extract relevant data to generate a summary that includes the following sections:

### 2-Page Summary

1. **Business Overview:**
   - Formation/Incorporation Date
   - Headquarters Location
   - Business Description
   - Employee Count
   - Latest Revenues
   - Stock Exchange Listing and Market Capitalization
   - Number of Offices and Locations
   - Details on Clients/Customers

2. **Business Segment Overview:**
   - Revenue Percentage of Each Component (Verticals, Products, Segments, Sections) as a Part of Total Revenue

3. **Performance:**
   - Performance of Each Component by Comparing Current Year's Sales/Revenue and Market Share with the Previous Year's Numbers
   - Explanation of Sales Increase/Decrease for Each Component

4. **Geographical Data:**
   - Breakdown of Sales and Revenue by Geography, Specifying the Percentage Contribution of Each Region to Total Sales
   - Summary of Workforce, Clients, and Offices by Region
   - Regional Plans for Expansion or Reduction
   - Analysis and Explanation of Regional Sales Fluctuations, Including Sales Trends

5. **Year-over-Year Sales Analysis:**
   - Year-over-Year Sales Increase or Decline and Reasons for the Change

6. **Rationale and Considerations:**
   - Summary of Rationale and Considerations, Including Risks and Mitigating Factors

7. **SWOT Analysis:**
   - Strengths
   - Weaknesses
   - Opportunities
   - Threats

8. **Credit Rating Information:**
   - Current Credit Rating
   - Any Changes in Credit Rating or Rating Outlook

---

### 1-Page Summary

Create a concise 1-page summary based on the 2-page summary. This summary should highlight the most important points and include the following:

1. **Business Overview:**
   - Key points from the Business Overview section, including formation date, headquarters, business description, and latest revenues.

2. **Business Segment Overview:**
   - Key numbers and percentages from the Business Segment Overview.

3. **Performance:**
   - Key highlights from the Performance section, focusing on major changes in sales/revenue and explanations.

4. **Geographical Data:**
   - Key points from the Geographical Data section, including percentage contributions from different regions and any significant regional plans or fluctuations.

5. **Year-over-Year Sales Analysis:**
   - Major highlights from the Year-over-Year Sales Analysis section.

6. **Rationale and Considerations:**
   - Key risks and mitigating factors from the Rationale and Considerations section.

7. **SWOT Analysis:**
   - Summarized points from the SWOT Analysis section.

8. **Credit Rating Information:**
   - Summary of the current credit rating and any recent changes.

Provide the relevant sections from the financial reports in a structured format, such as plain text or tables, to ensure accurate extraction and summarization.
Instructions for AI:
1. Extract relevant data from the provided financial reports.
2. Summarize the data into the specified sections.
3. Ensure clarity and conciseness in the summaries.
4. Provide explanations for any increases or decreases in performance.
5. Highlight key insights and trends.
